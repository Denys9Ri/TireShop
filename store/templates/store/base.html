<!DOCTYPE html>
{% load static %}
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F63L5ESNN8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-F63L5ESNN8');
    </script>

    <meta name="google-site-verification" content="D2aRaIcWDhooWV3K4uewL2EB9D3BUfH3t5M6hr7uL0I" />
    <meta name="description" content="–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —à–∏–Ω R16.com.ua. –ó–∏–º–æ–≤—ñ —Ç–∞ –ª—ñ—Ç–Ω—ñ —à–∏–Ω–∏. –°–∞–º–æ–≤–∏–≤—ñ–∑ —É –ö–∏—î–≤—ñ (–í—ñ–¥—Ä–∞–¥–Ω–∏–π), –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –£–∫—Ä–∞—ó–Ω—ñ. –ù–∏–∑—å–∫—ñ —Ü—ñ–Ω–∏, —à–∏—Ä–æ–∫–∏–π –≤–∏–±—ñ—Ä.">

    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
    <link rel="shortcut icon" type="image/png" href="{% static 'images/favicon.png' %}">
    <link rel="apple-touch-icon" href="{% static 'images/favicon.png' %}">

    <title>{% block title %}R16.com.ua - –®–∏–Ω–∏ –õ—ñ—Ç–Ω—ñ, –ó–∏–º–æ–≤—ñ —Ç–∞ –í—Å–µ—Å–µ–∑–æ–Ω–Ω—ñ{% endblock %}</title>
    
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        body {
            background-color: #f0f4f8;
            margin: 0;
            font-family: system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- –®–ê–ü–ö–ê --- */
        .navbar {
            background-color: rgba(0, 74, 153, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 8px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.15);
        }

        /* –õ–æ–≥–æ—Ç–∏–ø */
        .logo-link {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            line-height: 0;
        }
        .logo-link:active { transform: scale(0.95); }

        .logo-img {
            height: 55px;
            width: auto;
            object-fit: contain;
            display: block;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        /* –ú–µ–Ω—é (–î–µ—Å–∫—Ç–æ–ø) */
        .navbar-menu {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .navbar-item {
            color: rgba(255, 255, 255, 0.95);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            padding: 8px 0;
            position: relative;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .navbar-item::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: #ffc107;
            transition: width 0.3s;
        }
        .navbar-item:hover::after { width: 100%; }
        .navbar-item:hover { color: #fff; }

        /* –ö–Ω–æ–ø–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó */
        .btn-register {
            background-color: #ffc107;
            color: #004a99 !important;
            padding: 6px 20px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-register:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 193, 7, 0.4);
        }
        .btn-register::after { display: none; }

        .cart-icon-bi { font-size: 1.3rem; }

        /* –ì–∞–º–±—É—Ä–≥–µ—Ä */
        .hamburger {
            display: none;
            width: 36px;
            height: 36px;
            background: transparent;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            padding: 7px;
            flex-direction: column;
            justify-content: space-between;
        }

        .hamburger span {
            display: block;
            width: 100%;
            height: 2px;
            background-color: #ffffff;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        /* --- –ú–æ–±—ñ–ª—å–Ω–µ –º–µ–Ω—é (–≤–∏—Å—É–≤–Ω–µ) --- */
        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background-color: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            z-index: 1001;
            display: flex;
            flex-direction: column;
            padding: 80px 20px 20px;
            transition: right 0.3s ease;
        }

        .mobile-menu.is-active {
            right: 0;
        }

        .mobile-menu a, .mobile-menu button {
            display: block;
            padding: 15px;
            font-size: 1.1rem;
            color: #333;
            text-decoration: none;
            border-bottom: 1px solid #eee;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }

        .logout-button-mobile {
            color: #dc3545 !important;
        }

        main {
            flex: 1;
        }

        /* --- –ê–¥–∞–ø—Ç–∞—Ü—ñ—è --- */
        @media (max-width: 992px) {
            .navbar { padding: 8px 20px; }
            .logo-img { height: 40px; }
            .navbar-menu { display: none; }
            .hamburger { display: flex; }
        }
    </style>
</head>
<body>

<header class="navbar">
    <div class="navbar-brand">
        <a href="{% url 'catalog' %}" class="logo-link" aria-label="–ù–∞ –≥–æ–ª–æ–≤–Ω—É">
            <img src="{% static 'images/logo.png' %}" alt="R16 Logo" class="logo-img">
        </a>
    </div>

    <div class="navbar-menu">
        <a href="{% url 'about' %}" class="navbar-item">–ü—Ä–æ –Ω–∞—Å</a>
        
        <a href="{% url 'contacts' %}" class="navbar-item">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
        <a href="{% url 'delivery_payment' %}" class="navbar-item">–î–æ—Å—Ç–∞–≤–∫–∞</a>
        
        <a href="{% url 'store:cart_detail' %}" class="navbar-item">
            <i class="bi bi-cart3 cart-icon-bi"></i>
            –ö–æ—à–∏–∫ ({{ cart|length }})
        </a>
        
        {% if user.is_authenticated %}
            <a href="{% url 'users:profile' %}" class="navbar-item"><i class="bi bi-person-circle"></i> –ö–∞–±—ñ–Ω–µ—Ç</a>
            <form action="{% url 'logout' %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="navbar-item" style="background:none; border:none; cursor:pointer; font-family:inherit;">–í–∏–π—Ç–∏</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}" class="navbar-item">–í—Ö—ñ–¥</a>
            <a href="{% url 'users:register' %}" class="navbar-item btn-register">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
        {% endif %}
    </div>
    
    <button class="hamburger" id="hamburger-button">
        <span></span>
        <span></span>
        <span></span>
    </button>
</header>

<div class="mobile-menu" id="mobile-menu">
    <a href="{% url 'about' %}"><i class="bi bi-info-circle"></i> –ü—Ä–æ –Ω–∞—Å</a>
    
    <a href="{% url 'contacts' %}"><i class="bi bi-telephone"></i> –ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
    <a href="{% url 'delivery_payment' %}"><i class="bi bi-truck"></i> –î–æ—Å—Ç–∞–≤–∫–∞ —ñ –æ–ø–ª–∞—Ç–∞</a>
    <a href="{% url 'store:cart_detail' %}">
        <i class="bi bi-cart3"></i> –ö–æ—à–∏–∫ ({{ cart|length }})
    </a>
    
    {% if user.is_authenticated %}
        <a href="{% url 'users:profile' %}"><i class="bi bi-person"></i> –ú—ñ–π –ö–∞–±—ñ–Ω–µ—Ç</a>
        <form action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="logout-button-mobile"><i class="bi bi-box-arrow-right"></i> –í–∏–π—Ç–∏</button>
        </form>
    {% else %}
        <a href="{% url 'login' %}"><i class="bi bi-box-arrow-in-right"></i> –£–≤—ñ–π—Ç–∏</a>
        <a href="{% url 'users:register' %}"><i class="bi bi-person-plus"></i> –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
    {% endif %}
</div>

<main class="container">
    {% block content %}{% endblock %}
</main>

<footer class="footer">
    <div class="footer-content">
        <div class="footer-brand">
            <p class="footer-title">R16.com.ua</p>
            <p class="footer-subtitle">–®–∏–Ω–∏ —Ç–∞ —Å–µ—Ä–≤—ñ—Å, —è–∫–æ–º—É –¥–æ–≤—ñ—Ä—è—é—Ç—å</p>
        </div>
        <div class="footer-contacts">
            <div class="footer-contact-item">
                <a href="tel:+380666881491" class="footer-link"><i class="bi bi-phone"></i> +38 (066) 688-14-91</a>
            </div>
            <div class="footer-contact-item">
                <a href="mailto:r16info2025@gmail.com" class="footer-link"><i class="bi bi-envelope"></i> r16info2025@gmail.com</a>
            </div>
        <div class="schedule-block">
            <div class="fw-bold text-warning mb-1"><i class="bi bi-clock-history me-1"></i> –ì—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏:</div>
             <div class="d-flex justify-content-center gap-3 flex-wrap">
                <span>–ü–Ω‚Äì–ü—Ç: 09:00 ‚Äì 19:00</span>
                <span>–°–±: 10:00 ‚Äì 16:00</span>
                <span style="color: #ff6b6b;">–ù–¥: –í–∏—Ö—ñ–¥–Ω–∏–π</span>
            </div>
        </div>
            <div class="mt-3" style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                <a href="{% url 'about' %}" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem;">–ü—Ä–æ –Ω–∞—Å</a>
                <a href="{% url 'delivery_payment' %}" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem;">–î–æ—Å—Ç–∞–≤–∫–∞</a>
                <a href="{% url 'warranty' %}" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem;">–ì–∞—Ä–∞–Ω—Ç—ñ—è</a>
                <a href="{% url 'contacts' %}" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem;">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
            </div>

        </div>
    </div>
    <p class="footer-legal">Copyright ¬©2025 R16.com.ua All rights reserved</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const hamburgerButton = document.getElementById('hamburger-button');
    const mobileMenu = document.getElementById('mobile-menu');
    
    document.addEventListener('click', function(event) {
        const isClickInsideMenu = mobileMenu.contains(event.target);
        const isClickOnButton = hamburgerButton.contains(event.target);
        
        if (!isClickInsideMenu && !isClickOnButton && mobileMenu.classList.contains('is-active')) {
            mobileMenu.classList.remove('is-active');
            toggleHamburgerAnimation(false);
        }
    });

    hamburgerButton.addEventListener('click', function() {
        mobileMenu.classList.toggle('is-active');
        toggleHamburgerAnimation(mobileMenu.classList.contains('is-active'));
    });

    function toggleHamburgerAnimation(isActive) {
        const spans = hamburgerButton.querySelectorAll('span');
        if (isActive) {
            spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
            spans[1].style.opacity = '0';
            spans[2].style.transform = 'rotate(-45deg) translate(5px, -5px)';
            spans[0].style.backgroundColor = '#333';
            spans[2].style.backgroundColor = '#333';
        } else {
            spans[0].style.transform = 'none';
            spans[1].style.opacity = '1';
            spans[2].style.transform = 'none';
            spans[0].style.backgroundColor = '#fff';
            spans[2].style.backgroundColor = '#fff';
        }
    }
</script>
<style>
    /* –ö–ù–û–ü–ö–ê-–®–ò–ù–ê */
    .tire-bot-btn {
        width: 50px; height: 50px;
        background-color: #1a1a1a;
        border: 2px dashed #555; /* –ü—Ä–æ—Ç–µ–∫—Ç–æ—Ä */
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 22px;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative; z-index: 100;
    }
    .tire-bot-btn:hover {
        transform: rotate(180deg) scale(1.1); /* –ï—Ñ–µ–∫—Ç –∫–æ—á–µ–Ω–Ω—è */
        border-color: #777;
        box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    }
    .tire-bot-btn::after { /* –î–∏—Å–∫ */
        content: ''; position: absolute;
        width: 36px; height: 36px;
        border-radius: 50%; border: 1px solid #444;
    }

    /* –ü–ª–∞–≤–∞—é—á–∞ –∫–Ω–æ–ø–∫–∞ (–°–ø—Ä–∞–≤–∞ –≤–Ω–∏–∑—É) */
    .floating-bot {
        position: fixed; bottom: 30px; right: 30px;
        width: 65px; height: 65px; z-index: 9999;
    }
    .floating-bot::after { width: 48px; height: 48px; }

    /* –í–Ü–ö–ù–û –ß–ê–¢–£ (GLASSMORPHISM) */
    .chat-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000; display: none;
        align-items: center; justify-content: center;
        backdrop-filter: blur(4px);
    }
    .chat-window {
        width: 90%; max-width: 400px; height: auto; min-height: 400px;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.9); /* –°–∫–ª–æ */
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        display: flex; flex-direction: column; overflow: hidden;
        animation: botPop 0.3s ease-out;
    }
    @keyframes botPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    /* –ï–ª–µ–º–µ–Ω—Ç–∏ —á–∞—Ç—É */
    .chat-header { padding: 15px 20px; background: rgba(255,255,255,0.6); border-bottom: 1px solid rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
    .chat-body { padding: 20px; flex: 1; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; max-height: 60vh; }
    
    .msg { padding: 12px 16px; border-radius: 12px; font-size: 0.95rem; line-height: 1.4; max-width: 85%; }
    .msg-bot { background: white; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .msg-user { background: #0d6efd; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

    .chat-suggestions { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
    .suggestion-btn {
        background: rgba(255,255,255,0.7); border: 1px solid #ccc;
        padding: 12px; border-radius: 12px; text-align: left;
        font-weight: 600; color: #444; cursor: pointer; transition: 0.2s;
        display: flex; align-items: center; gap: 10px;
    }
    .suggestion-btn:hover { background: #0d6efd; color: white; border-color: #0d6efd; }
    .suggestion-btn i { font-size: 1.2rem; }

    /* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥—Ä—É–∫—É */
    .typing { display: none; align-self: flex-start; background: white; padding: 10px 15px; border-radius: 15px; }
    .dot { display: inline-block; width: 6px; height: 6px; background: #bbb; border-radius: 50%; margin: 0 2px; animation: jump 1.4s infinite; }
    .dot:nth-child(2) { animation-delay: 0.2s; } .dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
</style>

<div class="tire-bot-btn floating-bot" onclick="openChat()">
    <i class="bi bi-robot"></i>
</div>

<div id="chatOverlay" class="chat-overlay">
    <div class="chat-window">
        <div class="chat-header">
            <h6 class="mb-0 fw-bold">ü§ñ R16 –ï–∫—Å–ø—Ä–µ—Å-–ø—ñ–¥–±—ñ—Ä</h6>
            <button onclick="closeChat()" class="btn-close"></button>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="msg msg-bot">
                –ü—Ä–∏–≤—ñ—Ç! üëã –Ø –¥–æ–ø–æ–º–æ–∂—É –ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ —à–∏–Ω–∏ –∑–∞ 10 —Å–µ–∫—É–Ω–¥.
            </div>
            
            <div id="stepBudget">
                <div class="msg msg-bot">–ù–∞ —è–∫—É —Å—É–º—É —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç–µ? üí∞</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="nextStep('budget', 'cheap', 'üí∏ –•–æ—á—É –¥–µ—à–µ–≤—à–µ (–ï–∫–æ–Ω–æ–º)')">
                        <i class="bi bi-piggy-bank"></i> –•–æ—á—É –¥–µ—à–µ–≤—à–µ (–ï–∫–æ–Ω–æ–º)
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', '', '‚öñÔ∏è –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å')">
                        <i class="bi bi-check-circle"></i> –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'expensive', 'üíé –®—É–∫–∞—é –Ω–∞–π–∫—Ä–∞—â–µ (–¢–æ–ø)')">
                        <i class="bi bi-star-fill text-warning"></i> –®—É–∫–∞—é –Ω–∞–π–∫—Ä–∞—â–µ (–¢–æ–ø)
                    </div>
                </div>
            </div>

            <div class="typing" id="typingDots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
        </div>
    </div>
</div>

<style>
    /* –ö–ù–û–ü–ö–ê-–®–ò–ù–ê */
    .tire-bot-btn {
        width: 50px; height: 50px;
        background-color: #1a1a1a;
        border: 2px dashed #666;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 22px;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative; z-index: 100;
    }
    .tire-bot-btn:hover {
        transform: rotate(180deg) scale(1.1);
        border-color: #999;
        box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    }
    .tire-bot-btn::after {
        content: ''; position: absolute;
        width: 36px; height: 36px;
        border-radius: 50%; border: 1px solid #444;
    }

    /* –ü–ª–∞–≤–∞—é—á–∞ –∫–Ω–æ–ø–∫–∞ (–°–ø—Ä–∞–≤–∞ –≤–Ω–∏–∑—É) */
    .floating-bot {
        position: fixed; bottom: 30px; right: 30px;
        width: 65px; height: 65px; z-index: 9999;
    }
    .floating-bot::after { width: 48px; height: 48px; }

    /* –í–Ü–ö–ù–û –ß–ê–¢–£ */
    .chat-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000; display: none;
        align-items: center; justify-content: center;
        backdrop-filter: blur(4px);
    }
    .chat-window {
        width: 90%; max-width: 400px; height: auto; min-height: 480px;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        display: flex; flex-direction: column; overflow: hidden;
        animation: botPop 0.3s ease-out;
    }
    @keyframes botPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    .chat-header { padding: 15px 20px; background: rgba(255,255,255,0.6); border-bottom: 1px solid rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
    .chat-body { padding: 20px; flex: 1; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; max-height: 60vh; }
    
    .msg { padding: 12px 16px; border-radius: 12px; font-size: 0.95rem; line-height: 1.4; max-width: 85%; }
    .msg-bot { background: white; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .msg-user { background: #0d6efd; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

    /* –ü–æ–ª—è –¥–ª—è —Ä–æ–∑–º—ñ—Ä—É */
    .size-inputs { display: flex; gap: 5px; align-items: center; margin-top: 10px; }
    .size-input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 10px; text-align: center; font-weight: bold; font-size: 1.1rem; }
    .size-separator { font-weight: bold; color: #999; }

    .chat-suggestions { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
    .suggestion-btn {
        background: rgba(255,255,255,0.7); border: 1px solid #ccc;
        padding: 12px; border-radius: 12px; text-align: left;
        font-weight: 600; color: #444; cursor: pointer; transition: 0.2s;
        display: flex; align-items: center; gap: 10px;
    }
    .suggestion-btn:hover { background: #0d6efd; color: white; border-color: #0d6efd; }
    .suggestion-btn i { font-size: 1.2rem; }

    .typing { display: none; align-self: flex-start; background: white; padding: 10px 15px; border-radius: 15px; }
    .dot { display: inline-block; width: 6px; height: 6px; background: #bbb; border-radius: 50%; margin: 0 2px; animation: jump 1.4s infinite; }
    .dot:nth-child(2) { animation-delay: 0.2s; } .dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
</style>

<div class="tire-bot-btn floating-bot" onclick="openChat()">
    <i class="bi bi-robot"></i>
</div>

<div id="chatOverlay" class="chat-overlay">
    <div class="chat-window">
        <div class="chat-header">
            <h6 class="mb-0 fw-bold">ü§ñ –ï–∫—Å–ø—Ä–µ—Å-–ø—ñ–¥–±—ñ—Ä R16</h6>
            <button onclick="closeChat()" class="btn-close"></button>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="msg msg-bot">–ü—Ä–∏–≤—ñ—Ç! üëã –Ø –¥–æ–ø–æ–º–æ–∂—É –∑–Ω–∞–π—Ç–∏ —à–∏–Ω–∏ –∑–∞ 3 –∫—Ä–æ–∫–∏.</div>
            
            <div id="stepSize">
                <div class="msg msg-bot">–í–≤–µ–¥—ñ—Ç—å —Ä–æ–∑–º—ñ—Ä —à–∏–Ω:</div>
                <div class="size-inputs">
                    <input type="number" id="botWidth" class="size-input" placeholder="205">
                    <span class="size-separator">/</span>
                    <input type="number" id="botProfile" class="size-input" placeholder="55">
                    <span class="size-separator">R</span>
                    <input type="number" id="botDiameter" class="size-input" placeholder="16">
                </div>
                <button class="btn btn-primary w-100 mt-3 rounded-pill fw-bold" onclick="validateSize()">
                    –î–∞–ª—ñ <i class="bi bi-arrow-right"></i>
                </button>
            </div>

            <div id="stepBudget" style="display: none;">
                <div class="msg msg-bot">–Ø–∫–∏–π —É –≤–∞—Å –±—é–¥–∂–µ—Ç? üí∞</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="nextStep('budget', 'cheap', 'üí∏ –ï–∫–æ–Ω–æ–º (–ù–∞–π–¥–µ—à–µ–≤—à—ñ)')">
                        <i class="bi bi-piggy-bank"></i> –ï–∫–æ–Ω–æ–º (–ù–∞–π–¥–µ—à–µ–≤—à—ñ)
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'medium', '‚öñÔ∏è –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å (–≤—ñ–¥ 1800 –≥—Ä–Ω)')">
                        <i class="bi bi-check-circle"></i> –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'expensive', 'üíé –¢–æ–ø –ë—Ä–µ–Ω–¥–∏ (Michelin —ñ —Ç.–¥.)')">
                        <i class="bi bi-star-fill text-warning"></i> –¢–æ–ø –ë—Ä–µ–Ω–¥–∏
                    </div>
                </div>
            </div>

            <div id="stepSeason" style="display: none;">
                <div class="msg msg-bot">–ù–∞ —è–∫–∏–π —Å–µ–∑–æ–Ω –ø–æ—Ç—Ä—ñ–±–Ω—ñ? üöó</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="finishBot('winter')"><i class="bi bi-snow text-info"></i> –ó–∏–º–æ–≤—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('summer')"><i class="bi bi-sun-fill text-warning"></i> –õ—ñ—Ç–Ω—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('all-season')"><i class="bi bi-cloud-sun text-success"></i> –í—Å–µ—Å–µ–∑–æ–Ω–Ω—ñ</div>
                </div>
            </div>

            <div class="typing" id="typingDots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
        </div>
    </div>
</div>

<style>
    /* –ö–ù–û–ü–ö–ê-–®–ò–ù–ê */
    .tire-bot-btn {
        width: 50px; height: 50px;
        background-color: #1a1a1a;
        border: 2px dashed #555;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 22px;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative; z-index: 100;
    }
    .tire-bot-btn:hover {
        transform: rotate(180deg) scale(1.1);
        border-color: #777;
        box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    }
    .tire-bot-btn::after {
        content: ''; position: absolute;
        width: 36px; height: 36px;
        border-radius: 50%; border: 1px solid #444;
    }

    .floating-bot {
        position: fixed; bottom: 30px; right: 30px;
        width: 65px; height: 65px; z-index: 9999;
    }
    .floating-bot::after { width: 48px; height: 48px; }

    /* –í–Ü–ö–ù–û –ß–ê–¢–£ */
    .chat-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000; display: none;
        align-items: center; justify-content: center;
        backdrop-filter: blur(4px);
    }
    .chat-window {
        width: 90%; max-width: 400px; height: auto; min-height: 450px;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        display: flex; flex-direction: column; overflow: hidden;
        animation: botPop 0.3s ease-out;
    }
    @keyframes botPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    .chat-header { padding: 15px 20px; background: rgba(255,255,255,0.6); border-bottom: 1px solid rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
    .chat-body { padding: 20px; flex: 1; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; max-height: 60vh; }
    
    .msg { padding: 12px 16px; border-radius: 12px; font-size: 0.95rem; line-height: 1.4; max-width: 85%; }
    .msg-bot { background: white; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .msg-user { background: #0d6efd; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

    /* –ü–æ–ª—è –≤–≤–æ–¥—É —Ä–æ–∑–º—ñ—Ä—É */
    .size-inputs { display: flex; gap: 5px; align-items: center; margin-top: 10px; }
    .size-input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; text-align: center; font-weight: bold; font-size: 1.1rem; }
    .size-separator { font-weight: bold; color: #999; }

    .chat-suggestions { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
    .suggestion-btn {
        background: rgba(255,255,255,0.7); border: 1px solid #ccc;
        padding: 12px; border-radius: 12px; text-align: left;
        font-weight: 600; color: #444; cursor: pointer; transition: 0.2s;
        display: flex; align-items: center; gap: 10px;
    }
    .suggestion-btn:hover { background: #0d6efd; color: white; border-color: #0d6efd; }
    
    .typing { display: none; align-self: flex-start; background: white; padding: 10px 15px; border-radius: 15px; }
    .dot { display: inline-block; width: 6px; height: 6px; background: #bbb; border-radius: 50%; margin: 0 2px; animation: jump 1.4s infinite; }
    .dot:nth-child(2) { animation-delay: 0.2s; } .dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
</style>

<div class="tire-bot-btn floating-bot" onclick="openChat()">
    <i class="bi bi-robot"></i>
</div>

<div id="chatOverlay" class="chat-overlay">
    <div class="chat-window">
        <div class="chat-header">
            <h6 class="mb-0 fw-bold">ü§ñ R16 –ï–∫—Å–ø—Ä–µ—Å-–ø—ñ–¥–±—ñ—Ä</h6>
            <button onclick="closeChat()" class="btn-close"></button>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="msg msg-bot">–ü—Ä–∏–≤—ñ—Ç! üëã –Ø –¥–æ–ø–æ–º–æ–∂—É —à–≤–∏–¥–∫–æ –∑–Ω–∞–π—Ç–∏ —à–∏–Ω–∏.</div>
            
            <div id="stepSize">
                <div class="msg msg-bot">–í–≤–µ–¥—ñ—Ç—å —Ä–æ–∑–º—ñ—Ä:</div>
                <div class="size-inputs">
                    <input type="number" id="botWidth" class="size-input" placeholder="205">
                    <span class="size-separator">/</span>
                    <input type="number" id="botProfile" class="size-input" placeholder="55">
                    <span class="size-separator">R</span>
                    <input type="number" id="botDiameter" class="size-input" placeholder="16">
                </div>
                <button class="btn btn-primary w-100 mt-3 rounded-pill fw-bold" onclick="validateSize()">–î–∞–ª—ñ <i class="bi bi-arrow-right"></i></button>
            </div>

            <div id="stepBudget" style="display: none;">
                <div class="msg msg-bot">–ù–∞ —è–∫—É —Å—É–º—É —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç–µ? üí∞</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="nextStep('budget', 'cheap', 'üí∏ –•–æ—á—É –¥–µ—à–µ–≤—à–µ')">
                        <i class="bi bi-piggy-bank"></i> –•–æ—á—É –¥–µ—à–µ–≤—à–µ
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'medium', '‚öñÔ∏è –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å')">
                        <i class="bi bi-check-circle"></i> –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å
                    </div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'expensive', 'üíé –¢–æ–ø –ë—Ä–µ–Ω–¥–∏')">
                        <i class="bi bi-star-fill text-warning"></i> –¢–æ–ø –ë—Ä–µ–Ω–¥–∏
                    </div>
                </div>
            </div>

            <div id="stepSeason" style="display: none;">
                <div class="msg msg-bot">–ù–∞ —è–∫–∏–π —Å–µ–∑–æ–Ω –ø–æ—Ç—Ä—ñ–±–Ω—ñ? üöó</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="finishBot('winter')"><i class="bi bi-snow text-info"></i> –ó–∏–º–æ–≤—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('summer')"><i class="bi bi-sun-fill text-warning"></i> –õ—ñ—Ç–Ω—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('all-season')"><i class="bi bi-cloud-sun text-success"></i> –í—Å–µ—Å–µ–∑–æ–Ω–Ω—ñ</div>
                </div>
            </div>

            <div class="typing" id="typingDots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
        </div>
    </div>
</div>

<style>
    /* –ö–Ω–æ–ø–∫–∞-—à–∏–Ω–∞ */
    .tire-bot-btn { width: 50px; height: 50px; background: #1a1a1a; border: 2px dashed #666; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 22px; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3); transition: 0.4s; position: relative; z-index: 100; }
    .tire-bot-btn:hover { transform: rotate(180deg) scale(1.1); border-color: #999; }
    .tire-bot-btn::after { content: ''; position: absolute; width: 36px; height: 36px; border-radius: 50%; border: 1px solid #444; }
    .floating-bot { position: fixed; bottom: 30px; right: 30px; z-index: 9999; width: 65px; height: 65px; }
    .floating-bot::after { width: 48px; height: 48px; }

    /* –í—ñ–∫–Ω–æ —á–∞—Ç—É */
    .chat-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
    .chat-window { width: 90%; max-width: 400px; height: auto; min-height: 500px; border-radius: 20px; background: rgba(255,255,255,0.95); box-shadow: 0 20px 50px rgba(0,0,0,0.2); display: flex; flex-direction: column; overflow: hidden; animation: botPop 0.3s ease-out; }
    @keyframes botPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    .chat-header { padding: 15px 20px; background: rgba(255,255,255,0.8); display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; }
    .chat-body { padding: 20px; flex: 1; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; max-height: 60vh; }
    
    .msg { padding: 12px 16px; border-radius: 12px; font-size: 0.95rem; max-width: 85%; }
    .msg-bot { background: #f1f3f5; align-self: flex-start; border-bottom-left-radius: 2px; }
    .msg-user { background: #0d6efd; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

    .size-inputs { display: flex; gap: 5px; margin-top: 10px; }
    .size-input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 10px; text-align: center; font-weight: bold; font-size: 1.1rem; }
    
    .chat-suggestions { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
    .suggestion-btn { background: #fff; border: 1px solid #dee2e6; padding: 12px; border-radius: 12px; text-align: left; cursor: pointer; font-weight: 600; transition: 0.2s; display: flex; align-items: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .suggestion-btn:hover { background: #0d6efd; color: white; border-color: #0d6efd; }
    
    .typing { display: none; align-self: flex-start; background: white; padding: 10px 15px; border-radius: 15px; }
    .dot { display: inline-block; width: 6px; height: 6px; background: #bbb; border-radius: 50%; margin: 0 2px; animation: jump 1.4s infinite; }
    .dot:nth-child(2) { animation-delay: 0.2s; } .dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
</style>

<div class="tire-bot-btn floating-bot" onclick="openChat()"><i class="bi bi-robot"></i></div>

<div id="chatOverlay" class="chat-overlay">
    <div class="chat-window">
        <div class="chat-header">
            <h6 class="mb-0 fw-bold">ü§ñ R16 –ï–∫—Å–ø—Ä–µ—Å-–ø—ñ–¥–±—ñ—Ä</h6>
            <button onclick="closeChat()" class="btn-close"></button>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="msg msg-bot">–ü—Ä–∏–≤—ñ—Ç! üëã –Ø –¥–æ–ø–æ–º–æ–∂—É –∑–Ω–∞–π—Ç–∏ —à–∏–Ω–∏.</div>
            
            <div id="stepSize">
                <div class="msg msg-bot">–°–ø–æ—á–∞—Ç–∫—É –≤–≤–µ–¥—ñ—Ç—å —Ä–æ–∑–º—ñ—Ä:</div>
                <div class="size-inputs">
                    <input type="number" id="botW" class="size-input" placeholder="205">
                    <input type="number" id="botP" class="size-input" placeholder="55">
                    <input type="number" id="botD" class="size-input" placeholder="16">
                </div>
                <button class="btn btn-primary w-100 mt-3 rounded-pill fw-bold" onclick="validateSize()">–î–∞–ª—ñ <i class="bi bi-arrow-right"></i></button>
            </div>

            <div id="stepBudget" style="display: none;">
                <div class="msg msg-bot">–Ø–∫–∏–π —É –≤–∞—Å –±—é–¥–∂–µ—Ç? üí∞</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="nextStep('budget', 'cheap', 'üí∏ –•–æ—á—É –¥–µ—à–µ–≤—à–µ')">üí∏ –•–æ—á—É –¥–µ—à–µ–≤—à–µ</div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'medium', '‚öñÔ∏è –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å')">‚öñÔ∏è –¶—ñ–Ω–∞ / –Ø–∫—ñ—Å—Ç—å</div>
                    <div class="suggestion-btn" onclick="nextStep('budget', 'expensive', 'üíé –¢–æ–ø –ë—Ä–µ–Ω–¥–∏')">üíé –¢–æ–ø –ë—Ä–µ–Ω–¥–∏</div>
                </div>
            </div>

            <div id="stepSeason" style="display: none;">
                <div class="msg msg-bot">–ù–∞ —è–∫–∏–π —Å–µ–∑–æ–Ω –ø–æ—Ç—Ä—ñ–±–Ω—ñ? üöó</div>
                <div class="chat-suggestions">
                    <div class="suggestion-btn" onclick="finishBot('winter')">‚ùÑÔ∏è –ó–∏–º–æ–≤—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('summer')">‚òÄÔ∏è –õ—ñ—Ç–Ω—ñ</div>
                    <div class="suggestion-btn" onclick="finishBot('all-season')">üå§ –í—Å–µ—Å–µ–∑–æ–Ω–Ω—ñ</div>
                </div>
            </div>

            <div class="typing" id="typingDots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
        </div>
    </div>
</div>

<script>
    const chatOverlay = document.getElementById('chatOverlay');
    const chatBody = document.getElementById('chatBody');
    const typingDots = document.getElementById('typingDots');
    
    let botState = { width: '', profile: '', diameter: '', budget: '', season: '' };

    function openChat() { chatOverlay.style.display = 'flex'; }
    function closeChat() { chatOverlay.style.display = 'none'; }
    chatOverlay.addEventListener('click', (e) => { if(e.target === chatOverlay) closeChat(); });

    function validateSize() {
        const w = document.getElementById('botW').value;
        const p = document.getElementById('botP').value;
        const d = document.getElementById('botD').value;

        if (!w || !p || !d) { alert("–í–≤–µ–¥—ñ—Ç—å —Ä–æ–∑–º—ñ—Ä!"); return; }

        botState.width = w; botState.profile = p; botState.diameter = d;

        addUserMsg(`${w} / ${p} R${d}`);
        document.getElementById('stepSize').style.display = 'none';
        
        showTypingAndNext('stepBudget');
    }

    function nextStep(step, value, text) {
        // –•–æ–≤–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫—Ä–æ–∫—É
        const currentStepDiv = document.getElementById(step === 'budget' ? 'stepBudget' : 'stepSeason');
        currentStepDiv.style.display = 'none'; // –ü–æ–≤–Ω—ñ—Å—Ç—é —Ö–æ–≤–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ –∫–Ω–æ–ø–∫–∞–º–∏

        botState[step] = value;
        addUserMsg(text);

        if (step === 'budget') {
            showTypingAndNext('stepSeason');
        }
    }

    function finishBot(season) {
        document.getElementById('stepSeason').style.display = 'none';
        botState.season = season;
        
        let seasonText = season === 'winter' ? '–ó–∏–º–æ–≤—ñ' : (season === 'summer' ? '–õ—ñ—Ç–Ω—ñ' : '–í—Å–µ—Å–µ–∑–æ–Ω–Ω—ñ');
        addUserMsg(seasonText);

        const botMsg = document.createElement('div');
        botMsg.className = 'msg msg-bot';
        botMsg.innerHTML = '–®—É–∫–∞—é –≤–∞—Ä—ñ–∞–Ω—Ç–∏... üîç';
        chatBody.appendChild(botMsg);
        
        setTimeout(() => {
            let url = `{% url 'catalog' %}?width=${botState.width}&profile=${botState.profile}&diameter=${botState.diameter}&season=${botState.season}`;
            if (botState.budget) url += `&ordering=${botState.budget}`;
            window.location.href = url;
        }, 1000);
    }

    function addUserMsg(text) {
        const msg = document.createElement('div');
        msg.className = 'msg msg-user';
        msg.innerText = text;
        chatBody.insertBefore(msg, typingDots);
    }

    function showTypingAndNext(nextId) {
        typingDots.style.display = 'block';
        chatBody.scrollTop = chatBody.scrollHeight;
        
        setTimeout(() => {
            typingDots.style.display = 'none';
            document.getElementById(nextId).style.display = 'block';
            chatBody.scrollTop = chatBody.scrollHeight;
        }, 600);
    }
</script>
</body>
</html>
