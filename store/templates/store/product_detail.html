{% extends 'store/base.html' %}
{% load static %}

{% block title %}{{ product.brand.name|default_if_none:'' }} {{ product.name }} - TireShop.ua{% endblock %}

{% block content %}
<div class="product-detail">
    <a href="{% url 'catalog' %}" class="back-link">← Повернутися до каталогу</a>
    <div class="product-detail__header">
        <div class="product-detail__image">
            {% if product.photo_url %}
                {% if product.photo_url.url %}
                    <img src="{{ product.photo_url.url }}" alt="{{ product.name }}">
                {% else %}
                    <img src="{{ product.photo_url }}" alt="{{ product.name }}">
                {% endif %}
            {% else %}
                <img src="{% static 'images/no-image.png' %}" alt="Немає фото">
            {% endif %}
        </div>
        <div class="product-detail__info">
            <h1>{{ product.brand.name|default_if_none:'' }} {{ product.name }}</h1>
            <p class="product-detail__specs">{{ product.width }}/{{ product.profile }} R{{ product.diameter }} ({{ product.get_seasonality_display }})</p>
            <p class="product-detail__price">{{ product.cost_price|floatformat:2 }} грн</p>
            <div class="product-detail__stock">Наявність: {{ product.stock_quantity }} шт.</div>
            <form action="{% url 'store:cart_add' product.id %}" method="post" class="product-detail__cart-form">
                {% csrf_token %}
                <button type="submit" class="add-to-cart-btn">Додати в кошик</button>
            </form>
        </div>
    </div>

    {% if product.description %}
    <div class="product-detail__section">
        <h2>Опис</h2>
        <div class="product-detail__description">{{ product.description|linebreaks }}</div>
    </div>
    {% endif %}

    {% with product.images.all as gallery %}
    {% if gallery %}
    <div class="product-detail__section">
        <h2>Додаткові фото</h2>
        <div class="product-detail__gallery">
            {% for image in gallery %}
                <img src="{{ image.image_url }}" alt="{{ product.name }} фото {{ forloop.counter }}">
            {% empty %}
            {% endfor %}
        </div>
    </div>
    {% endif %}
    {% endwith %}
</div>
{% endblock %}
